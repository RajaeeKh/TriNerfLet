code here is clonned from:
https://github.com/kwea123/ngp_pl